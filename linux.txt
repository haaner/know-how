Disk: 

	- Block-Devices inklusive Größen und RAID-Gruppierung auflisten
		
		$ lsblk
MD:

	- RAID1 anlegen
	
		$ mdadm --create --verbose /dev/md0 --level=1 --raid-devices=2 /dev/sda3 /dev/sdc3
		
	- Platte aus RAID-Verbund entfernen
	
		$ mdadm --manage /dev/md0 --fail /dev/sda1
		$ mdadm --manage /dev/md0 --remove /dev/sda1
		
	- Platte in RAID-Verbund aufnehmen
	
		$ mdadm --manage /dev/md0 --add /dev/sda1
		
	- RAID löschen
	
		$ mdadm --stop /dev/md1 
		$ mdadm --remove /dev/md1
		$ mdadm --zero-superblock /dev/sdb1 /dev/sdd1 # wichtig sonst gibts evtl. Probleme beim Booting (mit grub)
		
	- RAID wieder starten (um zuvor gestoppte Verbünde wieder zu starten)
	
		$ mdadm --assemble --scan

LVM:

	- Snapshot erstellen, wiederherstellen bzw. löschen:
	
		$ lvcreate  -L360G -s -n 150-disk-snap /dev/ubuntu-vg/server150-disk
		$ lvconvert --merge /dev/ubuntu-vg/150-disk-snap
		$ lvs -a # zeigt an wie lange die endgültige Wiederherstellung noch dauert
		$ lvremove /dev/ubuntu-vg/150-disk-snap

	- Falls eine Snapshot-Wiederherstellung fehlschlägt:
     
		Den Server bzw. Prozess herunterfahren, der die ursprüngliche LV blockiert
     
		$ lvchange --refresh ubuntu-vg
		$ lvs

		Sobald der Data%-Wert auf 0 heruntergezählt hat, ist der Snapshot gemerged.
	
	- LV klonen
	
		$ lvconvert --type mirror --alloc anywhere -m1 /dev/rootvg/test
		$ lvs -a -o +devices | egrep "LV|test"
		
			LV              VG     Attr       LSize .. ove Log       Cpy%Sync Convert Devices                          
			test            rootvg mwi-aom--- 1.00g      [test_mlog] 100.00           test_mimage_0(0),test_mimage_1(0)
			[test_mimage_0] rootvg iwi-aom--- 1.00g                                   /dev/sda5(87200)                 
			[test_mimage_1] rootvg iwi-aom--- 1.00g                                   /dev/sda5(36009)                 
			[test_mlog]     rootvg lwa-aom--- 4.00m                                   /dev/sda5(66575)                 

		Check that Cpy%Sync is 100% finished; both copies are in sync then. Now let's break the mirror !

		$ lvconvert --splitmirrors 1 --name testCopy /dev/rootvg/test
  		$ mount /dev/rootvg/testCopy /mnt/test_copy
	
	- LV Binärkopie erstellen
		
		$ lvcreate --snapshot --name <the-name-of-the-snapshot> --size <size> /dev/volume-group/logical-volume
		$ lvcreate --name <logical-volume-name> --size <size> the-new-volume-group-name
		$ dd if=/dev/volume-group/snapshot-name of=/dev/new-volume-group/new-logical-volume
		
Debian / Ubuntu: 

	- Installierte Pakete der Größe nach sortieren auflisten
		
		$ dpkg-query -Wf '${Installed-Size}\t${Package}\n' | sort -n
		
	- Installierte (Alt-)Kernel auflisten
	
		$ dpkg --list | grep -i -E --color 'linux-image|linux-kernel' | grep '^ii'
		
	- Separates Repository hinzufügen
	
		$ add-apt-repository ppa:rdiff-backup/rdiff-backup-backports
		$ add-apt-repository ppa:ondrej/php	
	
	- Repository-Key hinzufügen
	
		$ apt-key adv --keyserver keyserver.ubuntu.com --recv 3B4FE6ACC0B21F32
		$ apt-key export 3B4FE6ACC0B21F32 | gpg --dearmour -o key.gpg
		$ apt-key del 3B4FE6ACC0B21F32
		$ mv key.gpg /etc/apt/trusted.gpg.d
				
	- Nur Security-Updates einspielen
	
		$ apt-get -s dist-upgrade | grep "^Inst" | grep -i securi | awk -F " " {'print $2'} | xargs apt-get install
				
	- Manuell installierte Pakete anzeigen

		$ apt-mark showmanual		

Services:

	$ systemctl list-unit-files | grep enabled
	$ systemctl enable php7.4-fpm-eibe

	$ service apache2 restart

				
# vim: ts=4:sw=4
